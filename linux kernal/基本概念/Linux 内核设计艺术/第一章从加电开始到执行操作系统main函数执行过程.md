[toc]

# 1. 背景
从加电到执行操作系统main函数主要分以下三步:
    * 启动BIOS，准备中断向量表和中断服务程序
    * 从启动盘加载操作系统到内存，加载工作就是有前面中断服务程序执行的
    * 执行main函数前做一些过渡工作


# 2. 启动BIOS，准备中断向量表和中断服务程序

## 2.1 BIOS
### 2.1.1 BIOS 启动

BIOS启动之前RAM中什么都没有，那么BIOS程序由什么来执行呢？（此时操作系统还未被加载）

* 既然先在程序中没有软件，那么就由硬件来执行程序。
* Intel 8086 系列芯片都被设计成加电进入16位实模式状态。同时非常关键的是CPU加电瞬间强行将CS值设计为0xF0000，IP设计为OxFFF0，这样CS:IP就指向0xFFFF0，这里正好指向BIOS地址范围。
* 0xFFFF0 必须是BIOS程序入口地址，如果不是，计算机就死机。

![2019-08-12-11-42-26.png](./images/2019-08-12-11-42-26.png)


### 2.1.2 BIOS在内存中加载中断向量表和中断服务程序

* BIOS程序量不大但是非常精深，并且要把很多硬件都了解清楚，这不是我想研究方向，因此下面只是理解加载中断向量表和中断服务程序。

* BIOS 是被固化在ROM中，启动BIOS后会进行检查显卡内存等工作，这期间执行非常重要的工作是建立中断向量表和中断服务程序。
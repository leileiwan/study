<!-- TOC -->

- [1. 背景](#1-背景)
- [2. CAP原则](#2-cap原则)
    - [2.1 A、P区别](#21-ap区别)
    - [2.2 CA实现](#22-ca实现)
    - [2.3 CP、AP](#23-cpap)

<!-- /TOC -->
# 1. 背景
* CAP原则又称CAP定理，指的是在一个分布式系统中，一致性（Consistency）、可用性（Availability）、分区容错性（Partition tolerance）。CAP 原则指的是，这三个要素最多只能同时实现两点，不可能三者兼顾。

    * 一致性（C）：在分布式系统中的所有数据备份，在同一时刻是否同样的值。（等同于所有节点访问同一份最新的数据副本）
    * 可用性（A）：在集群中一部分节点故障后，集群整体是否还能响应客户端的读写请求。（对数据更新具备高可用性）
    * 分区容忍性（P）：以实际效果而言，分区相当于对通信的时限要求。系统如果不能在时限内达成数据一致性，就意味着发生了分区的情况，必须就当前操作在C和A之间做出选择。

# 2. CAP原则
CAP原则又称CAP定理，指的是在一个分布式系统中， Consistency（一致性）、 Availability（可用性）、Partition tolerance（分区容错性），三者不可得兼。

* 仔细理解P的概念，发现P并不是实现分布式所实现的功能，而是一种状态。也就是如果网络不同，整个系统因为不能实现一致性而造成分区状态（脑裂）。
* C和A描述的是功能，C标识一致性，A表示高可用

## 2.1 A、P区别
最开始理解CAP的时候总是区分不开A、P区别。
* P标识出现部分故障这种状态同时不能达成一致性的状态
* A表示出现部分故障之后，能否为用户提供服务
* P 要求故障级别达到不能实现一致性。而A只要求部分故障，可能还是能实现一致性的

## 2.2 CA实现
如果只有一份数据，那么一致性和高可用是可以同时满足的

## 2.3 CP、AP
* 上面的单点数据很显然容易出现单点故障，所有在分布式系统中，P是必须要实现的
* 在分布式环境下，为了保证系统可用性，通常都采取了复制的方式，避免一个节点损坏，导致系统不可用。那么就出现了每个节点上的数据出现了很多个副本的情况，而数据从一个节点复制到另外的节点时需要时间和要求网络畅通的，所以，当P发生时，也就是无法向某个节点复制数据时，这时候你有两个选择：
    * 选择可用性 A(Availability)，此时，那个失去联系的节点依然可以向系统提供服务，不过它的数据就不能保证是同步的了（失去了C属性）。
    * 选择一致性C(Consistency)，为了保证数据库的一致性，我们必须等待失去联系的节点恢复过来，在这个过程中，那个节点是不允许对外提供服务的，这时候系统处于不可用状态(失去了A属性)。



